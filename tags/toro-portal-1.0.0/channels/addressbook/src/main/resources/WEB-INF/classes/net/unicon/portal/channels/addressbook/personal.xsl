<?xml version="1.0" encoding="UTF-8"?><!--      Copyright (c) 2002, Dan Phong Ltd (IBS-DP). All Rights Reserved.       This software is the confidential and proprietary information of    Dan Phong Ltd (IBS-DP)  ("Confidential Information"). You shall not    disclose such Confidential Information and shall use it only in    accordance with the terms of the license agreement you entered into    with IBS-DP or its authorized distributors.       IBS-DP MAKES NO REPRESENTATIONS OR WARRANTIES ABOUT THE SUITABILITY    OF THE SOFTWARE, EITHER EXPRESSED OR IMPLIED, INCLUDING BUT NOT    LIMITED TO THE IMPLIED WARRANTIES OF MERCHANTABILITY, FITNESS FOR A    PARTICULAR PURPOSE, OR NON-INFRINGEMENT. IBS-DP SHALL NOT BE LIABLE    FOR ANY DAMAGES SUFFERED BY LICENSEE AS A RESULT OF USING, MODIFYING    OR DISTRIBUTING THIS SOFTWARE OR ITS DERIVATIVES.  --><xsl:stylesheet xmlns:xsl="http://www.w3.org/1999/XSL/Transform" version="1.0">  <xsl:import href="lib.xsl"/>  <xsl:import href="common.xsl"/>  <xsl:output method="html"/>  <xsl:param name="baseActionURL">default</xsl:param>  <xsl:param name="sid">default</xsl:param>  <xsl:param name="goURL"/>  <xsl:param name="doURL"/>  <xsl:param name="baseImagePath">media/net/unicon/portal/channels</xsl:param>  <!--/////////////////////////////////////////////////////////////////////////////// -->  <xsl:param name="openFolder">-1</xsl:param>  <xsl:param name="nPages">10</xsl:param>  <xsl:param name="curPage">2</xsl:param>  <!--Start = 0-->  <!--/////////////////////////////////////////////////////////////////////////////// -->  <xsl:template match="/">    <form method="post" action="{$baseActionURL}" name="addressBookForm" id="addressBookForm">      <input type="hidden" name="sid" value="{$sid}"/>      <input type="hidden" name="uP_root" value="me"/>      <xsl:call-template name="links"/>      <div class="page-title">My Address Book</div>            <div class="page-toolbar-container">      	<xsl:call-template name="page-links"/>      </div>            <xsl:apply-templates/>    </form>  </xsl:template>  <!--////////////////////////////////////////////////// -->  <xsl:template match="addressbook-system">    <table border="0" cellPadding="0" cellSpacing="0" width="100%">      <tr>        <!-- Left: Folders -->        <td width="1%" valign="top"><xsl:call-template name="folders"/></td>        <!-- Right: Contacts -->        <td width="99%" valign="top">          <table border="0" cellPadding="0" cellSpacing="0" width="100%">            <xsl:apply-templates select="contact"/>          </table>        </td>      </tr>      <xsl:if test="number($nPages) &gt; 0">        <tr class="table-nav"><td colspan="2"><xsl:call-template name="navigation"/></td></tr>      </xsl:if>    </table>  </xsl:template>  <!--////////////////////////////////////////////////// -->  <xsl:template name="folders">    <table border="0" width="100%" cellpadding="0" cellspacing="0">      <!-- Special folder (all) -->      <xsl:choose>        <!--Opening folder -->        <xsl:when test="$openFolder='-1'">          <td class="table-content-right" nowrap="nowrap">             <xsl:text>&#160;</xsl:text>             <img align="absMiddle" border="0" src="{$baseImagePath}/rad/folder_open_16.gif" alt="Open Folder" title="Open Folder"/>             <a class="uportal-navigation-channel" title="Viewing all contacts">&#160;All&#160;</a>          </td>        </xsl:when>        <!--Closing folder -->        <xsl:otherwise>          <td class="table-content-right" nowrap="nowrap">            <xsl:text>&#160;</xsl:text>            <a class="uportal-navigation-channel" href="{$doURL}=open&amp;folderid=-1" title="Display all contacts">              <img align="absMiddle" border="0" src="{$baseImagePath}/rad/folder_closed_16.gif" alt="Closed Folder" title="Closed Folder"/>              &#160;All&#160;            </a>          </td>        </xsl:otherwise>      </xsl:choose>      <!-- Others folders -->      <xsl:apply-templates select="folder"/>      </table>  </xsl:template>  <!--////////////////////////////////////////////////// -->  <xsl:template match="contact">    <tr>      <!-- Contact name -->      <td width="100%" class="table-content-right" nowrap="nowrap" valign="middle">        <img src="{$baseImagePath}/rad/card_16.gif" border="0" align="absmiddle" alt="Contact:" title="Contact:"/>        <xsl:text>&#160;</xsl:text>        <a href="{$doURL}=editContact&amp;uP_root=me&amp;contactid={@id}" title="Edit this contact" onmouseover="swapImage('addressBookContactEditImage{position()}','channel_edit_active.gif')" onmouseout="swapImage('addressBookContactEditImage{position()}','channel_edit_base.gif')">          <xsl:value-of select="name"/>          <img border="0" height="1" width="3" src="{$SPACER}" alt="" title=""/>          <img border="0" src="{$CONTROLS_IMAGE_PATH}/channel_edit_base.gif" align="absmiddle" name="addressBookContactEditImage{position()}" id="addressBookContactEditImage{position()}" alt="Edit this contact" title="Edit this contact"/>        </a>        <img border="0" height="1" width="3" src="{$SPACER}" alt="" title=""/>        <a href="{$doURL}=confirmDelContact&amp;uP_root=me&amp;contactid={@id}" title="Delete this contact" onmouseover="swapImage('addressBookContactDeleteImage{position()}','channel_delete_active.gif')" onmouseout="swapImage('addressBookContactDeleteImage{position()}','channel_delete_base.gif')">          <img border="0" src="{$CONTROLS_IMAGE_PATH}/channel_delete_base.gif" align="absmiddle" name="addressBookContactDeleteImage{position()}" id="addressBookContactDeleteImage{position()}" alt="Delete this contact" title="Delete this contact"/>        </a>        <!-- Other informations -->        <!-- Title Department Company-->        <xsl:variable name="line1">          <xsl:call-template name="esc-strings">          <xsl:with-param name="title" select="title/text()"/>          <xsl:with-param name="department" select="department/text()"/>          <xsl:with-param name="company" select="company/text()"/>          </xsl:call-template>        </xsl:variable>        <xsl:if test="boolean($line1=' ')=false and boolean($line1='')=false">          <br/>&#160;&#160;<xsl:value-of select="$line1"/>        </xsl:if>        <!-- cell-phone, office-phone, home-phone, email -->        <xsl:variable name="line2">          <xsl:call-template name="esc-strings">            <xsl:with-param name="cell-phone" select="cell-phone/text()"/>            <xsl:with-param name="business-phone" select="business-phone/text()"/>            <xsl:with-param name="home-phone" select="home-phone/text()"/>            <xsl:with-param name="email" select="email/text()"/>          </xsl:call-template>        </xsl:variable>        <xsl:if test="boolean($line2=' ')=false and boolean($line2='')=false">          <br/>&#160;&#160;<xsl:value-of select="$line2"/>        </xsl:if>      </td>    </tr>  </xsl:template>  <!--////////////////////////////////////////////////// -->  <xsl:template name="navigation">      <!-- Previous -->      <xsl:choose>        <xsl:when test="number($curPage) &gt; 0">          <a href="{$doURL}=prev&amp;uP_root=me" title="Previous Page">            <img align="absmiddle" border="0" src="{$baseImagePath}/rad/prev_12.gif" alt="Previous" title="Previous"/>          </a>        </xsl:when>        <xsl:otherwise>          <img src="{$baseImagePath}/rad/prev_disabled_12.gif" border="0" align="absmiddle" alt="Currently viewing first page" title="Currently viewing first page"/>        </xsl:otherwise>      </xsl:choose>      <!-- curPage/nPages -->      <xsl:text>&#160;</xsl:text>      <xsl:value-of select="number($curPage)+1"/>/<xsl:value-of select="$nPages"/>      <xsl:text>&#160;</xsl:text>      <!-- Next -->      <xsl:choose>        <xsl:when test="number($curPage) &lt; number($nPages) - 1">          <a href="{$doURL}=next&amp;uP_root=me" title="Next Page">            <img align="absmiddle" border="0" src="{$baseImagePath}/rad/next_12.gif" alt="Next" title="Next"/>          </a>        </xsl:when>        <xsl:otherwise>          <img src="{$baseImagePath}/rad/next_disabled_12.gif" border="0" align="absmiddle" alt="Currently viewing last page" title="Currently viewing last page"/>        </xsl:otherwise>      </xsl:choose>      <img src="{$SPACER}" border="0" width="1" alt="" title=""/>  </xsl:template>    <!--////////////////////////////////////////////// -->    <xsl:template match="folder">      <tr>        <xsl:choose>          <xsl:when test="$openFolder=@id">            <!--Opening folder -->            <td class="table-content-right" nowrap="nowrap">              <xsl:text>&#160;</xsl:text>              <img align="absmiddle" border="0" src="{$baseImagePath}/rad/folder_open_16.gif" alt="Open Folder" title="Open Folder"/>              <a class="uportal-navigation-channel" title="Close folder">&#160;<xsl:value-of select="text()"/></a>              <img border="0" height="1" width="3" src="{$SPACER}" alt="" title=""/>              <a href="{$doURL}=editFolder&amp;uP_root=me&amp;folderid={@id}" title="Edit this group" onmouseover="swapImage('addressBookGroupEditImage{position()}','channel_edit_active.gif')" onmouseout="swapImage('addressBookGroupEditImage{position()}','channel_edit_base.gif')">                <img border="0" src="{$CONTROLS_IMAGE_PATH}/channel_edit_base.gif" align="absmiddle" name="addressBookGroupEditImage{position()}" id="addressBookGroupEditImage{position()}" alt="Edit this group" title="Edit this group"/>              </a>              <img border="0" height="1" width="3" src="{$SPACER}" alt="" title=""/>              <a href="{$doURL}=confirmDelFolder&amp;uP_root=me&amp;folderid={@id}" title="Delete this group" onmouseover="swapImage('addressBookGroupDeleteImage{position()}','channel_delete_active.gif')" onmouseout="swapImage('addressBookGroupDeleteImage{position()}','channel_delete_base.gif')">                <img border="0" src="{$CONTROLS_IMAGE_PATH}/channel_delete_base.gif" align="absmiddle" name="addressBookGroupDeleteImage{position()}" id="addressBookGroupDeleteImage{position()}" alt="Delete this group" title="Delete this group"/>              </a>            </td>          </xsl:when>          <!--Closed folder -->          <xsl:otherwise>            <td class="table-content-right" nowrap="nowrap">              <xsl:text>&#160;</xsl:text>              <a class="uportal-navigation-channel" title="Open folder" href="{$doURL}=open&amp;folderid={@id}">                <img align="absMiddle" border="0" src="{$baseImagePath}/rad/folder_closed_16.gif" alt="Closed Folder" title="Closed Folder"/>&#160;<xsl:value-of select="text()"/>              </a>              <img border="0" height="1" width="3" src="{$SPACER}" alt="" title=""/>              <a href="{$doURL}=editFolder&amp;uP_root=me&amp;folderid={@id}" title="Edit this group" onmouseover="swapImage('addressBookGroupEditImage{position()}','channel_edit_active.gif')" onmouseout="swapImage('addressBookGroupEditImage{position()}','channel_edit_base.gif')">                <img border="0" src="{$CONTROLS_IMAGE_PATH}/channel_edit_base.gif" align="absmiddle" name="addressBookGroupEditImage{position()}" id="addressBookGroupEditImage{position()}" alt="Edit this group" title="Edit this group"/>              </a>              <img border="0" height="1" width="3" src="{$SPACER}" alt="" title=""/>              <a href="{$doURL}=confirmDelFolder&amp;uP_root=me&amp;folderid={@id}" title="Delete this group" onmouseover="swapImage('addressBookGroupDeleteImage{position()}','channel_delete_active.gif')" onmouseout="swapImage('addressBookGroupDeleteImage{position()}','channel_delete_base.gif')">                <img border="0" src="{$CONTROLS_IMAGE_PATH}/channel_delete_base.gif" align="absmiddle" name="addressBookGroupDeleteImage{position()}" id="addressBookGroupDeleteImage{position()}" alt="Delete this group" title="Delete this group"/>              </a>             </td>          </xsl:otherwise>        </xsl:choose>      </tr>    </xsl:template></xsl:stylesheet>